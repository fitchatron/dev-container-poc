(function(e,o){typeof exports=="object"&&typeof module<"u"?module.exports=o(require("vue"),require("@popperjs/core"),require("jump.js")):typeof define=="function"&&define.amd?define(["vue","@popperjs/core","jump.js"],o):(e=typeof globalThis<"u"?globalThis:e||self,e.VueJsTour=o(e.vue,e.popper,e.jump))})(this,function(e,o,g){"use strict";const j=e.createElementVNode("div",{id:"vjt-backdrop","data-hidden":""},null,-1),C={id:"vjt-tooltip","data-hidden":"",role:"tooltip"},b=["innerHTML"],T={class:"vjt-actions"},_=["textContent"],w=["textContent"],L=["textContent"],k=e.createElementVNode("div",{id:"vjt-arrow","data-popper-arrow":""},null,-1),x={__name:"VTour",props:{name:{type:String,default:"default"},steps:{type:Array,required:!0},backdrop:{type:Boolean,default:!1},autoStart:{type:Boolean,default:!1},startDelay:{type:Number,default:0},highlight:{type:Boolean,default:!1},buttonLabels:{type:Object,default:()=>({next:"Next",prev:"Back",finish:"Finish",skip:"Skip"})},saveToLocalStorage:{type:String,default:"end"}},emits:["onTourStart","onTourEnd"],setup(c,{expose:m,emit:E}){const f=e.ref(!1),a=e.ref(null),t=e.reactive({currentStep:0,lastStep:null,getCurrentStep:e.computed(()=>r.steps[t.currentStep]),getLastStep:e.computed(()=>r.steps[t.lastStep])}),i=e.computed(()=>r.steps.length-1),I=e.computed(()=>t.currentStep===i.value?r.buttonLabels.finish:r.buttonLabels.next),r=c,h=E;m({startTour:l,nextStep:s,prevStep:d,endTour:u,goToStep:N,resetTour:q});async function l(){switch(r.saveToLocalStorage){case"end":if(localStorage.getItem("vjt-"+r.name)==="true")return;break;case"step":if(localStorage.getItem("vjt-"+r.name)==="true")return;if(localStorage.getItem("vjt-"+r.name)){t.currentStep=localStorage.getItem("vjt-"+r.name),t.lastStep=localStorage.getItem("vjt-"+r.name)-1>=0?localStorage.getItem("vjt-"+r.name)-1:0;break}break}if(document.querySelector(`${t.getCurrentStep.target}`)===null){t.currentStep++,l();return}setTimeout(()=>{r.backdrop===!0&&document.getElementById("vjt-backdrop").removeAttribute("data-hidden"),document.getElementById("vjt-tooltip").removeAttribute("data-hidden"),a.value=o.createPopper(document.querySelector(`${t.getCurrentStep.target}`),document.getElementById("vjt-tooltip"),{placement:`${t.getCurrentStep.placement?t.getCurrentStep.placement:"top"}`,modifiers:[{name:"offset",options:{offset:[0,8]}}]}),r.highlight&&y(),h("onTourStart"),f.value=!0},r.startDelay)}function y(){var v;let n=document.querySelector(`${t.getCurrentStep.target}`),p=document.querySelector(`${(v=t.getLastStep)==null?void 0:v.target}`);n.classList.add("vjt-highlight"),p!=null&&n!==p&&p.classList.remove("vjt-highlight")}async function s(){if(t.currentStep<i.value){for(t.getCurrentStep.onNext&&await t.getCurrentStep.onNext(),t.lastStep=t.currentStep,t.currentStep++,r.saveToLocalStorage==="step"&&localStorage.setItem("vjt-"+r.name,t.currentStep);document.querySelector(`${t.getCurrentStep.target}`)===null;){if(t.currentStep<=i.value)return u();t.currentStep++}await S();return}u()}async function d(){if(t.currentStep>0){for(t.getCurrentStep.onPrev&&await t.getCurrentStep.onPrev(),t.lastStep=t.currentStep,t.currentStep--,r.saveToLocalStorage==="step"&&localStorage.setItem("vjt-"+r.name,t.currentStep);document.querySelector(`${t.getCurrentStep.target}`)===null;)t.currentStep--;await S()}}function u(){var n;document.getElementById("vjt-tooltip").setAttribute("data-hidden",""),document.getElementById("vjt-backdrop").setAttribute("data-hidden",""),(n=document.querySelector(".vjt-highlight"))==null||n.classList.remove("vjt-highlight"),a.value.destroy(),(r.saveToLocalStorage==="end"||r.saveToLocalStorage==="step")&&localStorage.setItem("vjt-"+r.name,"true"),g(document.body,{duration:500}),h("onTourEnd")}async function N(n){for(f.value===!1&&await l(),t.getCurrentStep.onNext&&await t.getCurrentStep.onNext(),t.lastStep=n-1>=0?n-1:0,t.currentStep=n,r.saveToLocalStorage==="step"&&localStorage.setItem("vjt-"+r.name,t.currentStep);document.querySelector(`${t.getCurrentStep.target}`)===null;)t.currentStep++;await S()}function q(){t.currentStep=0,t.lastStep=0,(r.saveToLocalStorage==="end"||r.saveToLocalStorage==="step")&&localStorage.setItem("vjt-"+r.name,"true"),l()}async function S(){await a.value.setOptions({placement:`${t.getCurrentStep.placement?t.getCurrentStep.placement:"top"}`}),a.value.state.elements.reference=document.querySelector(`${t.getCurrentStep.target}`),await a.value.update(),g(document.querySelector(`${t.getCurrentStep.target}`),{duration:500,offset:-100}),r.highlight&&y(),t.getCurrentStep.onShow&&await t.getCurrentStep.onShow()}return e.onMounted(()=>{r.autoStart&&l()}),(n,p)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[j,e.createElementVNode("div",C,[e.renderSlot(n.$slots,"content",e.normalizeProps(e.guardReactiveProps({step:t})),()=>[e.createElementVNode("div",{innerHTML:t.getCurrentStep.content},null,8,b)]),e.renderSlot(n.$slots,"actions",e.normalizeProps(e.guardReactiveProps({endTour:u,nextStep:s,prevStep:d,step:t})),()=>[e.createElementVNode("div",T,[e.createElementVNode("button",{type:"button",onClick:e.withModifiers(u,["prevent"]),textContent:e.toDisplayString(r.buttonLabels.skip)},null,8,_),t.currentStep>0?(e.openBlock(),e.createElementBlock("button",{key:0,type:"button",textContent:e.toDisplayString(r.buttonLabels.prev),onClick:e.withModifiers(d,["prevent"])},null,8,w)):e.createCommentVNode("",!0),e.createElementVNode("button",{type:"button",textContent:e.toDisplayString(I.value),onClick:e.withModifiers(s,["prevent"])},null,8,L)])]),k])],64))}};return{install:(c,m)=>{c.component("VTour",x)}}});
